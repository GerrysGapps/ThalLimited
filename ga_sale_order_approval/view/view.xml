<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <report
            id="sale.action_report_saleorder"
            string="Quotation / Order"
            model="sale.order"
            report_type="qweb-pdf"
            file="sale.report_saleorder"
            name="sale.report_saleorder"
            menu="False"
            print_report_name="(object.state in ('draft', 'sent') and 'Quotation - %s' % (object.name)) or 'Order - %s' % (object.name)"
    />

    <record id="inherited_sale_approval_form" model="ir.ui.view">
        <field name="name">sale.order</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="priority">10</field>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='state']" position="after">
                <field name="management_approved" invisible="1"/>
            </xpath>
            <xpath expr="//button[@name='action_cancel']" position="after">
                <button attrs="{'invisible': ['|',('state', 'not in', ['draft']),('management_approved', '=', True)]}"
                        name="action_management_approved"
                        string="Management Approval"
                        type="object"
                        class="btn-primary o_sale_print"/>
            </xpath>
            <xpath expr="//button[@name='preview_sale_order']" position="attributes">
                <attribute name="attrs">{'invisible': ['|',('management_approved', '=', False)]}</attribute>
            </xpath>
            <xpath expr="//button[@name='print_quotation'][1]" position="attributes">
                <attribute name="attrs">{'invisible': ['|',('management_approved', '=', False)]}</attribute>
            </xpath>
            <xpath expr="//button[@name='print_quotation'][2]" position="attributes">
                <attribute name="attrs">{'invisible': ['|',('management_approved', '=', False)]}</attribute>
            </xpath>
            <xpath expr="//button[@name='action_quotation_send'][1]" position="attributes">
                <attribute name="attrs">{'invisible': ['|',('management_approved', '=', False)]}</attribute>
            </xpath>

            <xpath expr="//button[@name='action_quotation_send'][2]" position="attributes">
                <attribute name="attrs">{'invisible': ['|','|',('management_approved', '=', False),('state', '!=',
                    'draft'),('invoice_count','&gt;=',1)]}
                </attribute>
            </xpath>
            <xpath expr="//button[@name='action_quotation_send'][3]" position="attributes">
                <attribute name="attrs">{'invisible': ['|','|',('management_approved', '=', False),('state', '=',
                    'draft'),('invoice_count','&gt;=',1)]}
                </attribute>
            </xpath>

            <xpath expr="//button[@name='action_quotation_send'][4]" position="attributes">
                <attribute name="attrs">{'invisible': ['|',('management_approved', '=', False)]}</attribute>
            </xpath>

        </field>
    </record>

    <record id="inherits_product_limit_template" model="ir.ui.view">
        <field name="name">product.template.form</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_only_form_view"></field>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='list_price']" position="after">
                <field name="min_sale_price"/>
                <field name="max_sale_price"/>
            </xpath>
        </field>
    </record>


</odoo>


