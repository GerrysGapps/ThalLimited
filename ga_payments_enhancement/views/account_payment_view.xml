<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="ga_account_payment_form_view_" model="ir.ui.view">
            <field name="model">account.payment</field>
            <field name="inherit_id"
                   ref="account.view_account_payment_form"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='button_invoices']" position="after">
                    <button class="oe_stat_button" name="button_deductions" string="Deductions" type="object" attrs="{'invisible':[('has_deduction','=',False)]}" icon="fa-expand"/>
                     <button class="oe_stat_button" name="button_deductions" string="Deductions" type="object" attrs="{'invisible':[('advance_ref','=',False)]}" icon="fa-expand"/>
                </xpath>
                <xpath expr="//field[@name='payment_date']" position="before">
                    <field name="move_name" string="Journal Entry" readonly="1"/>
                </xpath>
                <xpath expr="//field[@name='payment_date']" position="after">
                    <field name="pay_ref"/>
                    <field name="is_alternative_account_head" attrs="{'invisible':[('payment_type','=','transfer')]}"/>
                    <field name="account_id" domain="['|',('user_type_id.name','=','Receivable'),('user_type_id.name','=','Payable')]" attrs="{'invisible':['|',('payment_type','=','transfer'),('is_alternative_account_head','=',False)],'required':[('is_alternative_account_head','=',True)]}"/>
                    <field name="advance_ref" invisible="1"/>
                    <field name="has_deduction" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='partner_type']" position="attributes">
                    <attribute name="attrs">{'invisible': ['|',('payslip', '!=', False),('payslip_batches', '!=', False)]}</attribute>
                </xpath>
                <xpath expr="//button[@name='post']" position="attributes">
                    <attribute name="string">Post</attribute>
                </xpath>
                <xpath expr="//button[@name='post']" position="after">
                    <button name="reset_to_draft" type="object" string="Reset To Draft" class="oe_highlight"
                            attrs="{'invisible':[('advance_ref','=',False),('has_deduction','=',False),('state','in',['draft','posted','reconciled'])]}"/>
                    <button name="cancel" type="object" string="Cancel Payment" class="oe_highlight"
                            states="posted,draft"/>

                    <!--<button name="generate_report" string="Payment Advice Report" type="object" class="oe_highlight"/>-->
                </xpath>
                <xpath expr="//group/group/field[@name='journal_id']"
                       position="after">
                    <field name="payslip_batches"
                           attrs="{'readonly': [('state', '!=', 'draft')],'invisible': ['|',('payslip', '!=', False),('partner_type', '=', 'customer')]}"/>
                    <field name="payslip"
                           attrs="{'domain':[('state','=','draft')],'readonly': [('state', '!=', 'draft')], 'invisible': ['|',('payslip_batches', '!=', False),('partner_type', '=', 'customer')]}"/>
                    <field name="has_deduction" invisible="1"/>
                    <field name="advance_ref" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='partner_id']"
                       position="attributes">
                    <attribute name="attrs">{'invisible': [('payslip_batches', '!=',
                        False)]}
                    </attribute>
                </xpath>
                <xpath expr="//field[@name='communication']"
                       position="attributes">
                    <attribute name="string">Cheque No.</attribute>
                </xpath>
                <xpath expr="//field[@name='communication']"
                       position="attributes">
                    <attribute name="attrs">{'invisible': [('state', '!=', 'draft'),
                        ('communication', '=', False)],
                        'readonly': [('state', '!=',
                        'draft')]}
                    </attribute>
                </xpath>
                <!--<xpath expr="//group" position="after">-->
                    <!--<group>-->
                        <!--<notebook>-->
                            <!--<page string="Deductions">-->
                                <!--<field name="deductions" nolabel="1" readonly="1">-->
                                    <!--<tree editable="bottom">-->
                                        <!--<field name="invoice_id" string="Vendor Bill/Customer Invoice" readonly="1"/>-->
                                        <!--<field name="balance_amt" readonly="1"/>-->
                                        <!--<field name="receiving_amt" readonly="1"/>-->
                                        <!--<field name="payment_difference" readonly="1"/>-->
                                        <!--<field name="writeoff_account_id_" string="Post Difference In" readonly="1"/>-->
                                        <!--&lt;!&ndash;<field name="description" readonly="1"/>&ndash;&gt;-->
                                        <!--&lt;!&ndash;<field name="amount_in_percent" string="Amount in %" readonly="1"/>&ndash;&gt;-->
                                        <!--&lt;!&ndash;<field name="writeoff_account_id" string="Post Difference In" readonly="1"/>&ndash;&gt;-->
                                    <!--</tree>-->
                                <!--</field>-->
                            <!--</page>-->
                        <!--</notebook>-->
                    <!--</group>-->
                <!--</xpath>-->
            </field>
        </record>
    </data>
</odoo>