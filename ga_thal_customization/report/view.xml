<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_topmanagment_document">

        <div class="page">
            <div class="oe_structure"/>
            <div class="row">
                <p align="center" style="font-weight:bold;font-size:30px;color:#800080">WEEKLY CRM REPORT</p>
                <t t-foreach="doc.get_details()" t-as="line">
                    <h1 style="font-weight:bold;" t-esc="line['company']"></h1>
                      <table BORDERCOLOR="#{'#00000'}"
                           border="1" cellpadding="0" cellspacing="0"
                           width="800px">
                        <tbody>
                            <tr t-attf-style="background-color:white">
                                <td class="text-left" width="400px" style="padding:5px">
                                  <span>LEAD CREATED :</span>
                                </td>
                               <td class="text-center" width="200px" style="padding:5px">
                                    <span t-esc="line['total_lead_count']"></span>
                                </td>
                                  <td class="text-left" width="400px" style="padding:5px">
                                  <span>LEAD CONVERTED TO OPPORTUNITIES:</span>
                                </td>
                               <td class="text-center" width="200px" style="padding:5px">
                                   <span t-esc="line['converted_opportunity_count']"></span>
                                </td>

                            </tr>
                             <tr t-attf-style="background-color:white">
                                <td class="text-left" width="400px" style="padding:5px">
                                  <span>OPEN OPPORTUNITIES:</span>
                                </td>
                               <td class="text-center" width="200px" style="padding:5px">
                                    <span t-esc="line['open_opportunity_count']"></span>
                                </td>
                                  <td class="text-left" width="400px" style="padding:5px">
                                  <span>LEAD CONVERSION RATIO :</span>
                                </td>
                               <td class="text-center" width="200px"  style="padding:5px">
                                   <span t-esc="line['conversion_ratio']"></span>
                                </td>

                            </tr>
                              <tr t-attf-style="background-color:white">
                              <td class="text-left" width="400px" style="padding:5px">
                                 <span>WON OPPORTUNITIES:</span>
                                </td>
                               <td class="text-center" width="200px" style="padding:5px">
                                      <span t-esc="line['won_opportunity_count']"></span>
                                </td>
                                    <td class="text-left" width="400px" style="padding:5px">
                                  <span>LOST OPPORTUNITIES</span>
                                </td>
                               <td class="text-center" width="200px" style="padding:5px">
                                    <span t-esc="line['lost_opportunity_count']"></span>
                                </td>
                              </tr>
                        </tbody>
                    </table>
                    <h2>BY SALE PERSONS </h2>
                     <h2>OPEN LEAD REPORT</h2>

                    <table BORDERCOLOR="#{'#ffffff'}"
                           border="1" cellpadding="0" cellspacing="0"
                           class="table table-bordered"
                           style="border:0.5px solid #ccc;  border-collapse: collapse; text-transform:capitalize; padding:15px;border-bottom:1px solid #ccc;"
                           width="100%">
                        <thead>
                            <tr t-attf-style="page-break-inside: avoid !important;padding:5px 10px; border:1px solid #{'#800080'}; font-weight:bold; background-color: #800080; color: white};">
                                <td align="left"
                                    t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">SALE PERSON
                                </td>
                                <td align="left"
                                    t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">OPEN LEAD COUNT
                                </td>
                                <td align="left"
                                     t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">INITIAL EXPECTED REVENUE
                                </td>
                                <td align="left"
                                   t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">CURRENT EXPECTED REVENUE
                                </td>
                                <td align="left"
                                    t-attf-style="font-weight:bold;color:white;"
                                    width="20%">DIFFERENCE
                                </td>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-if="line['sale_person_wise_open_lead']">
                                <t t-as="data" t-foreach="line['sale_person_wise_open_lead']">
                                    <tr t-attf-style="background-color:white">
                                        <td class="text-left" style="padding:5px"
                                        >
                                            <span t-esc="data['sale_person_name']"/>
                                        </td>

                                        <td class="text-left" style="padding:5px"
                                        >
                                            <span t-esc="data['count_opportunity']"/>
                                        </td>
                                        <td class="text-left" style="padding:5px"
                                        >
                                            <span t-esc="data['initial_expected_revenue']"/>
                                        </td>

                                        <td class="text-left" width="6%" style="padding:5px"
                                        >
                                            <span t-esc="data['current_expected_revenue']"/>
                                        </td>
                                         <td class="text-left" width="6%" style="padding:5px"
                                        >
                                            <span t-esc="data['difference_amount']"/>
                                        </td>

                                    </tr>
                                </t>
                            </t>
                        </tbody>
                    </table>
                     <h2>WON LEADS </h2>
                     <table BORDERCOLOR="#{'#ffffff'}"
                           border="1" cellpadding="0" cellspacing="0"
                           class="table table-bordered"
                           style="border:0.5px solid #ccc;  border-collapse: collapse; text-transform:capitalize; padding:15px;border-bottom:1px solid #ccc;"
                           width="100%">
                        <thead>
                            <tr t-attf-style="page-break-inside: avoid !important;padding:5px 10px; border:1px solid #{'#800080'}; font-weight:bold; background-color: #800080; color: white};">
                                <td align="left"
                                    t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">SALE PERSON
                                </td>
                                <td align="left"
                                    t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">WON LEAD COUNT
                                </td>
                                <td align="left"
                                     t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">INITIAL EXPECTED REVENUE
                                </td>
                                <td align="left"
                                   t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">CURRENT EXPECTED REVENUE
                                </td>
                                <td align="left"
                                    t-attf-style="font-weight:bold;color:white;"
                                    width="20%">DIFFERENCE
                                </td>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-if="line['sale_person_wise_won_lead']">
                                <t t-as="data" t-foreach="line['sale_person_wise_won_lead']">
                                    <tr t-attf-style="background-color:white">
                                        <td class="text-left" style="padding:5px"
                                        >
                                            <span t-esc="data['sale_person_name']"/>
                                        </td>

                                        <td class="text-left" style="padding:5px"
                                        >
                                            <span t-esc="data['count_opportunity']"/>
                                        </td>
                                        <td class="text-left" style="padding:5px"
                                        >
                                            <span t-esc="data['initial_expected_revenue']"/>
                                        </td>

                                        <td class="text-left" width="6%" style="padding:5px"
                                        >
                                            <span t-esc="data['current_expected_revenue']"/>
                                        </td>
                                         <td class="text-left" width="6%" style="padding:5px"
                                        >
                                            <span t-esc="data['difference_amount']"/>
                                        </td>

                                    </tr>
                                </t>
                            </t>
                        </tbody>
                    </table>
                     <h2>LEADS LOST BY REASONS </h2>
                     <table BORDERCOLOR="#{'#ffffff'}"
                           border="1" cellpadding="0" cellspacing="0"
                           class="table table-bordered"
                           style="border:0.5px solid #ccc;  border-collapse: collapse; text-transform:capitalize; padding:15px;border-bottom:1px solid #ccc;"
                           width="100%">
                        <thead>
                            <tr t-attf-style="page-break-inside: avoid !important;padding:5px 10px; border:1px solid #{'#800080'}; font-weight:bold; background-color: #800080; color: white};">
                                <td align="left"
                                    t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">LOST REASON
                                </td>
                                <td align="left"
                                    t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">LEAD COUNT
                                </td>
                                <td align="left"
                                     t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">INITIAL EXPECTED REVENUE
                                </td>
                                <td align="left"
                                   t-attf-style="font-weight:bold;color:white;border-right:1px solid white;"
                                    width="20%">CURRENT EXPECTED REVENUE
                                </td>
                                <td align="left"
                                    t-attf-style="font-weight:bold;color:white;"
                                    width="20%">DIFFERENCE
                                </td>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-if="line['lost_reason_wise_lead']">
                                <t t-as="data" t-foreach="line['lost_reason_wise_lead']">
                                    <tr t-attf-style="background-color:white">
                                        <td class="text-left" style="padding:5px"
                                        >
                                            <span t-esc="data['lost_reason']"/>
                                        </td>

                                        <td class="text-left" style="padding:5px"
                                        >
                                            <span t-esc="data['count_opportunity']"/>
                                        </td>
                                        <td class="text-left" style="padding:5px"
                                        >
                                            <span t-esc="data['initial_expected_revenue']"/>
                                        </td>

                                        <td class="text-left" width="6%" style="padding:5px"
                                        >
                                            <span t-esc="data['current_expected_revenue']"/>
                                        </td>
                                         <td class="text-left" width="6%" style="padding:5px"
                                        >
                                            <span t-esc="data['difference_amount']"/>
                                        </td>

                                    </tr>
                                </t>
                            </t>
                        </tbody>
                    </table>
                </t>
            </div>

            <!--<span t-esc="doc.get_details()"></span>-->
        </div>
    </template>

    <template id="report_top_management">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="ga_thal_customization.report_topmanagment_document"/>
            </t>
        </t>
    </template>


</odoo>
